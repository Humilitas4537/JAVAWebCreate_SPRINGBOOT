# SPRING_BOOT ê°œë°œ
[í”„ë¡œì íŠ¸ ë©”ì¸ ì£¼ì†Œ](https://github.com/Humilitas4537/JAVAWebCreate_SPRINGBOOT.git)

## ğŸ“˜ 2ì£¼ì°¨ ìë°”ì›¹ ê°œë°œ
### âœ… ìŠ¤í”„ë§ë¶€íŠ¸ ì¤€ë¹„ ë° ì‹¤í–‰
- í”„ë ˆì„ì›Œí¬ ìŠ¤í”„ë§ë¶€íŠ¸ ê°œë°œ í™˜ê²½ ì„¤ì •
- URI ë§¤í•‘ êµ¬í˜„
### âœ… ì—°ìŠµë¬¸ì œ 'URL ë§µí•‘ê³¼ ì»¨íŠ¸ë¡¤ëŸ¬ ì¶”ê°€' ì™„ë£Œ
- hello2.html ì‘ì„± ë° ë§¤í•‘ + 5ê°œ ì†ì„± ë³€ìˆ˜ ì¶œë ¥  

```java
@GetMapping("/hello2")
public String hello2(Model model) {
    model.addAttribute("data1", "modelë¡œ í˜ì´ì§€ì— ê·¸ë¦´ ì •ë³´ë¥¼ ì „ë‹¬í•©ë‹ˆë‹¤.");
    model.addAttribute("data2", "modelì€ key-value ê°’ìœ¼ë¡œ");
    model.addAttribute("data3", "thymeleafê°€ th: ì†ì„±ì— ë°ì´í„°ë¥¼ ë„£ì–´ì„œ í™”ë©´ì„ êµ¬ì„±í•©ë‹ˆë‹¤.");
    model.addAttribute("data4", "ì˜ˆ) th:text='${key}'");
    model.addAttribute("data5", "${}ëŠ” ë³€ìˆ˜ í‘œí˜„ì‹ìœ¼ë¡œ {}ì•ˆì— keyë¥¼ ë„£ìŠµë‹ˆë‹¤.");
    return "hello2";
}
```
```html
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>ë‘ë²ˆì§¸ Hello í˜ì´ì§€</title>
</head>
<body>
    <p th:text="${data1}"></p>
    <p th:text="${data2}"></p>
    <p th:text="${data3}"></p>
    <p th:text="${data4}"></p>
    <p th:text="${data5}"></p>
    <a href="/">ë©”ì¸ í™ˆí˜ì´ì§€</a>
</body>
</html>
```

## ğŸ“˜ 3ì£¼ì°¨ ìë°”ì›¹ ê°œë°œ
### âœ… ê°œì¸ í¬íŠ¸í´ë¦¬ì˜¤ í˜ì´ì§€ ì‘ì„±
- í˜ì´ì§€ ìˆ˜ì • ë° ë³€ê²½
- ìƒì„¸ ì†Œê°œ í˜ì´ì§€ ì‘ì„± & Mapping
### âœ… ì—°ìŠµë¬¸ì œ 'ìƒì„¸ í˜ì´ì§€ ìˆ˜ì •' ì™„ë£Œ
- ìƒì„¸ í˜ì´ì§€ 'ë˜ëŒì•„ê°€ê¸°' ë²„íŠ¼ ê¸°ëŠ¥ ìˆ˜ì •<br>

ì°½ì„ ë‹«ì„ì§€ í™•ì¸, 1ì´ˆ í›„ close
```js
// ìƒˆë¡œ ì¶”ê°€í•œ ì´ë²¤íŠ¸ : 'ë˜ëŒì•„ê°€ê¸°' ë²„íŠ¼ í´ë¦­ ì‹œ ì°½ì„ ë‹«ì„ ì§€ ë¬¼ì–´ë´„
function confirmClose(){
    if(confirm("ì •ë§ë¡œ ì°½ì„ ë‹«ìœ¼ì‹œê² ìŠµë‹ˆê¹Œ?")){
        alert("í™•ì¸ : trueê°’ í™•ì¸, 1ì´ˆ í›„ ì°½ì„ ë‹«ìŠµë‹ˆë‹¤.")
        // setTimeout(window.close,1000);
        setTimeout("window.close()",1000);
    }
    else{
        alert("ì·¨ì†Œ : falseê°’ í™•ì¸, ì°½ì„ ë‹«ì§€ ì•ŠìŠµë‹ˆë‹¤.")
    }
}
```
## ğŸ“˜ 4ì£¼ì°¨ ìë°”ì›¹ ê°œë°œ
### âœ… ë°ì´í„° ë² ì´ìŠ¤ ì—°ë™
- MySQL ì„¤ì¹˜
- ë°ì´í„° ë² ì´ìŠ¤ ìƒì„± ë° ì—°ë™
### âœ… ì—°ìŠµë¬¸ì œ 'ì‚¬ìš©ì ì¶”ê°€ ë° ì¶œë ¥í•˜ê¸°' ì™„ë£Œ
- DBì— 2ëª…ì˜ ì‚¬ìš©ì ì¶”ê°€, testdb.htmlì—ì„œ ì‚¬ìš©ì id, ì´ë¦„ ì¶œë ¥
```java
// Repository
TestDB findByName(String name);

// Service
public TestDB findByName(String name){ // ì´ë¦„ ì°¾ê¸°
    return (TestDB) testRepository.findByName(name);
}

// Controller
@GetMapping("/testdb")
public String getAllTestDBs(Model model) {
    TestDB test = testService.findByName("í™ê¸¸ë™");
    model.addAttribute("data4", test);
    System.out.println("ë°ì´í„° ì¶œë ¥ ë””ë²„ê·¸ : " + test);

    TestDB test1 = testService.findByName("ì•„ì €ì”¨");
    model.addAttribute("data5", test1);
    System.out.println("ë°ì´í„° ì¶œë ¥ ë””ë²„ê·¸ : " + test1);

    TestDB test2 = testService.findByName("ê¾¸ëŸ¬ê¸°");
    model.addAttribute("data6", test2);
    System.out.println("ë°ì´í„° ì¶œë ¥ ë””ë²„ê·¸ : " + test2);
    return "testdb";
}
```
```html
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>ë°ì´í„°ë² ì´ìŠ¤ í…ŒìŠ¤íŠ¸</title>
</head>
<body>
    <h1>User List</h1>
    <p>ì•„ì´ë””(ê¸°ë³¸í‚¤) : <span th:text="${data4.id}"></span></p>
    <p>ì´ë¦„ : <span th:text="${data4.name}"></span></p>
    <p>ì•„ì´ë””(ê¸°ë³¸í‚¤) : <span th:text="${data5.id}"></span></p>
    <p>ì´ë¦„ : <span th:text="${data5.name}"></span></p>
    <p>ì•„ì´ë””(ê¸°ë³¸í‚¤) : <span th:text="${data6.id}"></span></p>
    <p>ì´ë¦„ : <span th:text="${data6.name}"></span></p>
</body>
</html>
```

## ğŸ“˜ 5ì£¼ì°¨ ìë°”ì›¹ ê°œë°œ
### âœ… ë¸”ë¡œê·¸ ê²Œì‹œíŒ ê¸°ëŠ¥ ì¶”ê°€
- ê²Œì‹œíŒ í˜ì´ì§€ ì‘ì„±
- ë°ì´í„° ë² ì´ìŠ¤ì™€ ì—°ë™, ê²Œì‹œê¸€ ì¶”ê°€
### âœ… ì—°ìŠµë¬¸ì œ 'í˜ì´ì§€ ë¦¬ë‹¤ì´ë ‰íŠ¸' ì™„ë£Œ
- **ê²Œì‹œê¸€ ì¶”ê°€ í›„ ìë™ìœ¼ë¡œ /article_list ê²Œì‹œíŒ ì´ë™**

toEntity() ë©”ì„œë“œë¡œ ë¹Œë”íŒ¨í„´ì„ ì‚¬ìš©í•œ Article ìƒì„±ì í˜¸ì¶œ<br>
-> Article ê°ì²´ ìƒì„± ë° ì €ì¥
```java
// DTO : AddArticleRequest
public Article toEntity(){ // Article ê°ì²´ ìƒì„±
    return Article.builder()
        .title(title)
        .content(content)
        .build();
}

// service
public void save(AddArticleRequest request){
    blogRepository2.save(request.toEntity());
}
```
ë¦¬ë‹¤ì´ë ‰íŠ¸ë¡œ ë¸”ë¡œê·¸ ê²Œì‹œíŒ URI ìš”ì²­ ë° ì´ë™
```java
// Controller
@PostMapping("/api/articles") // post ìš”ì²­
public String addArticle(@ModelAttribute AddArticleRequest request) {
    blogService.save(request); // ê²Œì‹œê¸€ ì €ì¥
    return "redirect:/article_list";
}
```

## ğŸ“˜ 6ì£¼ì°¨ ìë°”ì›¹ ê°œë°œ
### :white_check_mark: ê²Œì‹œíŒ ìˆ˜ì •&ì‚­ì œ ë° ì—ëŸ¬ í˜ì´ì§€ ì¶”ê°€
- ìˆ˜ì •&ì‚­ì œ ë²„íŠ¼ êµ¬í˜„
- ì—ëŸ¬ í˜ì´ì§€ êµ¬í˜„
### :white_check_mark: ì—°ìŠµë¬¸ì œ 'ì˜ˆì™¸ì²˜ë¦¬' ì™„ë£Œ
- ë£¨íŠ¸ ê²½ë¡œ ë‚´ì—ì„œ ì˜ëª»ëœ í˜ì´ì§€ ì ‘ì† ì‹œ ì—ëŸ¬ í˜ì´ì§€ë¡œ ì´ë™
```java
@ControllerAdvice
public class ExceptionController{
    @ExceptionHandler(Exception.class)
    public String ExceptionControll(Model model, Exception exception){
        // ë°ì´í„° ë³´ë‚´ê¸°ë§Œ
        model.addAttribute("errorMsg", exception.getMessage());
        return "error_page/article_error";
    }
}
```

## ğŸ“˜ 7ì£¼ì°¨ ìë°”ì›¹ ê°œë°œ
### :white_check_mark: í¬íŠ¸í´ë¦¬ì˜¤ í˜ì´ì§€&ê²Œì‹œíŒ ì¶”ê°€ ìˆ˜ì •
- í¬íŠ¸í´ë¦¬ì˜¤ í˜ì´ì§€ í”„ë¡œì íŠ¸ í•­ëª© ìˆ˜ì •
- New ê²Œì‹œíŒ í˜ì´ì§€ ë° DB("Board") ìƒì„±
### âœ… ì—°ìŠµë¬¸ì œ 'ê²Œì‹œíŒ í˜ì´ì§€ - ê¸€ ìˆ˜ì •' ì™„ë£Œ
- <b>New ê²Œì‹œíŒì— ê¸€ ìˆ˜ì • ê¸°ëŠ¥ ì¶”ê°€</b>

board_edit í˜ì´ì§€ì—ì„œ ìˆ˜ì • ë²„íŠ¼ í´ë¦­ ì‹œ, ê²Œì‹œê¸€ **ì—…ë°ì´íŠ¸** ë™ì‘ ìˆ˜í–‰
```html
<form th:action="@{/api/board_edit/{id}(id=${board.id})}">
    <input type="hidden" name="_method" value="put">
</form>
```
ê²Œì‹œê¸€ ìˆ˜ì • í›„, ê²Œì‹œíŒ í˜ì´ì§€ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸
```java
// board ê²Œì‹œê¸€ ìˆ˜ì •
@PutMapping("/api/board_edit/{id}")
public String updateBoard(@PathVariable Long id, @ModelAttribute AddArticleRequest request){
    blogService.update(id, request);
    return "redirect:/board_list"; // ê¸€ ìˆ˜ì • ì´í›„ .html ì—°ê²°
}

public void update(Long id, AddArticleRequest request){
    Optional<Board> optionalBoard = blogRepository2.findById(id); // ë‹¨ì¼ ê¸€ ì¡°íšŒ
    optionalBoard.ifPresent(board -> { // ê°’ì´ ìˆìœ¼ë©´
        // @ModelAttributeë¡œ requestì— ë³€ìˆ˜ ë°”ì¸ë”©í•œ í¼ ë°ì´í„°ëŠ” titleê³¼ content ë¿.
        // í•˜ì§€ë§Œ Boardì˜ update ë©”ì„œë“œëŠ” ë¹Œë“œ íŒ¨í„´ì„ ì ìš©í•˜ì§€ ì•Šì•˜ìœ¼ë¯€ë¡œ ëª¨ë“  ë§¤ê°œë³€ìˆ˜ ê°’ì„ ë°›ì•„ì•¼ í•¨ -> Boardì˜ Getterë¡œ ì²˜ë¦¬
        board.update(request.getTitle(), request.getContent(), board.getUser(), board.getNewdate(), board.getCount(), board.getLikec());
        blogRepository2.save(board);
    });
}
```

## ğŸ“˜ 8ì£¼ì°¨ ìë°”ì›¹ ê°œë°œ
### :white_check_mark: ê²Œì‹œíŒ í˜ì´ì§€ ê¸°ëŠ¥ ì¶”ê°€
- ê²Œì‹œíŒ ê¸€ ì‘ì„± ê¸°ëŠ¥ ì¶”ê°€
- ê²Œì‹œê¸€ ê²€ìƒ‰ì°½ ë° í˜ì´ì§• ê¸°ëŠ¥ ì¶”ê°€
### âœ… ì—°ìŠµë¬¸ì œ 'ê²Œì‹œíŒ í˜ì´ì§€ - ì¶”ê°€ êµ¬í˜„' ì™„ë£Œ
- **ID ëŒ€ì‹ , ê²Œì‹œíŒ ë²ˆí˜¸ë¡œ ìˆœì„œëŒ€ë¡œ ì¶œë ¥**
```java
model.addAttribute("startNum", (page * pageable.getPageSize()) + 1);
```
ê²Œì‹œíŒ ë²ˆí˜¸ : ((í˜ì´ì§€ ë²ˆí˜¸ * í˜ì´ì§€ ë‹¹ ê²Œì‹œê¸€ ìˆ˜) + 1) + num.index<br>
num.indexëŠ” numì´ ë°˜ë³µë˜ì–´ í…Œì´ë¸” í–‰ì´ ì¶”ê°€ë  ë•Œë§ˆë‹¤ 0, 1, 2.. ì”© ì¦ê°€ <br>
ë”°ë¼ì„œ í˜ì´ì§€ ë²ˆí˜¸ê°€ 0 ì´ë©´ ê²Œì‹œíŒ ë²ˆí˜¸ëŠ” 1, 2, 3 ...
```html
<tbody>
    <tr th:each="board, num : ${boards}">
        <td th:text="${startNum} + ${num.index}"></td>
    </tr>
<tbody>
```
<br>

- **ê²Œì‹œê¸€ ì‚­ì œ ê¸°ëŠ¥ ì¶”ê°€**

board_view í˜ì´ì§€ì—ì„œ ì‚­ì œ ë²„íŠ¼ í´ë¦­ ì‹œ, ê²Œì‹œê¸€ ë°”ë¡œ ì‚­ì œ
```html
<!-- ì‚­ì œ ë²„íŠ¼ -->
<form th:action="@{/api/board_delete/{id}(id=${board.id})}" method="post" style="display:inline;">
    <input type="hidden" name="_method" value="delete">
    <button type="submit" class="btn btn-danger">ì‚­ì œ</button>
</form>
```
ì‚­ì œ í›„ board_list ê²Œì‹œíŒ í˜ì´ì§€ë¡œ ì´ë™
```java
@DeleteMapping("/api/article_delete/{id}")
public String deleteArticle(@PathVariable Long id){
    blogService.delete(id);
    return "redirect:/article_list";
}

// BlogService
public void delete(Long id){
    blogRepository2.deleteById(id);
}
```

## ğŸ“˜ 9ì£¼ì°¨ ìë°”ì›¹ ê°œë°œ
### :white_check_mark: ë¡œê·¸ì¸ ë° íšŒì›ê°€ì… ê¸°ëŠ¥ ì¶”ê°€
- íšŒì›ê°€ì… í˜ì´ì§€ ë° íšŒì› ì •ë³´ DB("Member") ì¶”ê°€ êµ¬í˜„
- ë¡œê·¸ì¸ ê¸°ëŠ¥ êµ¬í˜„ : íšŒì› ì •ë³´ ì¸ì¦ ì„±ê³µ ì‹œ ê²Œì‹œíŒ ì´ë™
### âœ… ì—°ìŠµë¬¸ì œ 'ì…ë ¥ê°’ í•„í„°ë§' ì™„ë£Œ
- **Validation ì–´ë…¸í…Œì´ì…˜ìœ¼ë¡œ DTO íšŒì›ì •ë³´ ì…ë ¥ê°’ ê²€ì¦**

ì˜ì¡´ì„± ì¶”ê°€
```xml
<dependency>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter-validation</artifactId>
</dependency>
```
DTO íšŒì›ì •ë³´ ì…ë ¥ê°’ í•„í„°ë§
```java
@NotBlank // ê³µë°±, ë¹ˆ ë¬¸ìì—´, Null í—ˆìš© X
@Pattern( // ì •ê·œì‹ ê²€ì‚¬
    regexp = "^[a-zA-Zê°€-í£]+$", 
    message = "ì´ë¦„ì—ëŠ” ìˆ«ìì™€ íŠ¹ìˆ˜ë¬¸ìë¥¼ ì‚¬ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤"
)
private String name;
@NotBlank
@Email // ì´ë©”ì¼ í˜•ì‹ ê²€ì‚¬ (ë¹ˆ ë¬¸ìì—´, Null -> í†µê³¼)
private String email;
@Pattern(
    regexp = "^(?=.*[a-z])(?=.*[A-Z])[a-zA-Z]+$",
    message = "ë¹„ë°€ë²ˆí˜¸ëŠ” ì˜ë¬¸ì´ê³  ëŒ€ë¬¸ìì™€ ì†Œë¬¸ìë¥¼ í¬í•¨í•´ì•¼í•©ë‹ˆë‹¤"
)
@Size(min = 8) // ê¸¸ì´ ì œí•œ
private String password;
@Max(value = 90) // ìµœëŒ€ê°’ ì§€ì •
@Min(value = 19) // ìµœì†Œê°’ ì§€ì •
private String age;
@NotEmpty // ê³µë°±ì€ í—ˆìš©, ë¹ˆ ë¬¸ìì—´ê³¼ Nullì€ í—ˆìš© X
private String mobile;
@NotEmpty
private String address;
```
íšŒì›ê°€ì… DTOë§Œ ì…ë ¥ê°’ ê²€ì¦<br>
DTO : @Valid - DTOì˜ Validation ì–´ë…¸í…Œì´ì…˜ ê²€ì‚¬<br>
Service ê³„ì¸µ : ë©”ì„œë“œì˜ ë§¤ê°œë³€ìˆ˜ Validation ì–´ë…¸í…Œì´ì…˜ ê²€ì¦
```java
// Controller
@PostMapping("/api/members") // @Valid : DTO(request)ì— ë¶™ì–´ìˆëŠ” Validation ì–´ë…¸í…Œì´ì…˜ ê²€ì‚¬
public String addmembers(@Valid @ModelAttribute AddMemberRequest request) {
    memberService.saveMember(request);
    return "join_end"; // .HTML ì—°ê²°
}

// Service
@Service
@Validated // ëª¨ë“  ë©”ì„œë“œì˜ ë§¤ê°œë³€ìˆ˜ Validation ì–´ë…¸í…Œì´ì…˜ ê²€ì¦
@Transactional // íŠ¸ëœì­ì…˜ ì²˜ë¦¬(í´ë˜ìŠ¤ ë‚´ ëª¨ë“  ë©”ì†Œë“œ ëŒ€ìƒ)
@RequiredArgsConstructor // final ë˜ëŠ” NonNull í•„ë“œì˜ ìƒì„±ì ìë™ ìƒì„± : ìƒì„±ì (ë¡œ ê°ì²´)ì£¼ì…
public class MemberService {
    public Member saveMember(@Valid AddMemberRequest request){}
}
```

## ğŸ“˜ 10ì£¼ì°¨ ìë°”ì›¹ ê°œë°œ
### :white_check_mark: ì„¸ì…˜ ì¿ í‚¤ì™€ ë¡œê·¸ì•„ì›ƒ ê¸°ëŠ¥ ì¶”ê°€
- ë¡œê·¸ì¸ ì‹œ ì„¸ì…˜ ì €ì¥ì†Œì— userID, email ìƒì„±
- securityConfig ë³´ì•ˆ ê´€ë¦¬ í´ë˜ìŠ¤ì— HttpSecurity ë³´ì•ˆ ì„¤ì • ì¶”ê°€
- ë¡œê·¸ì¸, ë¡œê·¸ì•„ì›ƒ ì‹œ ê¸°ì¡´ ì„¸ì…˜ ë¬´íš¨í™” -> ì„¸ì…˜ ì €ì¥ì†Œì™€ ì„¸ì…˜ ì¿ í‚¤ JSESSIONID ì‚­ì œ

### âœ… ì—°ìŠµë¬¸ì œ 'ê²Œì‹œíŒ ìˆ˜ì •í•˜ê¸°' ì™„ë£Œ
- **í˜„ì¬ ë¡œê·¸ì¸í•œ ì‚¬ìš©ìë¡œ ê¸€ ì‘ì„±ì ì €ì¥**

ì‹¤ì œ ê¸€ ì‘ì„± ë¡œì§ì—ì„œ íšŒì›ì˜ ì´ë¦„ ì •ë³´ë¥¼ ê°€ì ¸ì™€ ê²Œì‹œê¸€ DTO ìˆ˜ì •
```java
// board ê²Œì‹œíŒ ê¸€ ì¶”ê°€
@PostMapping("/api/boards") // ê¸€ì“°ê¸° ê²Œì‹œíŒ ì €ì¥
public String addboards(@ModelAttribute AddArticleRequest request, HttpSession session) {
    String email = (String) session.getAttribute("email");
    Member member = memberRepository.findByEmail(email);
    request.setUser(member.getName());;
    blogService.save(request);
    return "redirect:/board_list"; // .HTML ì—°ê²°
}
```
- **ê¸€ ì‘ì„±ìë§Œ board_view/{id} ì—ì„œ ìˆ˜ì •/ì‚­ì œ ë²„íŠ¼ ì ‘ê·¼ ê°€ëŠ¥**

Board, Memberì˜ ì‹¤ì œ ë¬¸ìì—´ ê°’ ë¹„êµëŠ” equals() í™œìš©<br>
== : ì°¸ì¡°ê°’ ë¹„êµ
```java
// ê²Œì‹œê¸€ ì¡°íšŒ
@GetMapping("/board_view/{id}") // ê²Œì‹œíŒ ë§í¬ ì§€ì •
public String board_view(Model model, @PathVariable Long id, HttpSession session) {
    Optional<Board> list = blogService.findById(id); // ì„ íƒí•œ ê²Œì‹œíŒ ê¸€
    if (list.isPresent()) {
        model.addAttribute("boards", list.get()); // ì¡´ì¬í•  ê²½ìš° ì‹¤ì œ Board ê°ì²´ë¥¼ ëª¨ë¸ì— ì¶”ê°€
    } else {
    // ì²˜ë¦¬í•  ë¡œì§ ì¶”ê°€ (ì˜ˆ: ì˜¤ë¥˜ í˜ì´ì§€ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸, ì˜ˆì™¸ ì²˜ë¦¬ ë“±)
        return "/error_page/article_error"; // ì˜¤ë¥˜ ì²˜ë¦¬ í˜ì´ì§€ë¡œ ì—°ê²°
    }

    // ìˆ˜ì •, ì‚­ì œ ë²„íŠ¼ ë…¸ì¶œ ê²°ì •
    String email = (String) session.getAttribute("email");
    Member member = memberRepository.findByEmail(email);
    if(list.get().getUser().equals(member.getName())){
        model.addAttribute("user", true);
    }
    return "board_view"; // .HTML ì—°ê²°
}
```
```html
<tr th:each="board : ${boards}" th:if="${user}">
```

## ğŸ“˜ 11ì£¼ì°¨ ìë°”ì›¹ ê°œë°œ
### :white_check_mark: í”„ë¡œí•„ ë©”ì¼ ì—…ë¡œë“œ ê¸°ëŠ¥ ì¶”ê°€
- ë©”ì¼ ê¸°ëŠ¥ -> .txt íŒŒì¼ë¡œ vscodeì— ìƒì„±
- ê¸°ë³¸ ì§€ë„ ìœ„ì¹˜ ìˆ˜ì •
### âœ… ì—°ìŠµë¬¸ì œ 'ì„¸ì…˜ ì²˜ë¦¬, íŒŒì¼ ì—…ë¡œë“œ' ì™„ë£Œ
- **ë‹¤ì¤‘ ë¡œê·¸ì¸ / ë¡œê·¸ì•„ì›ƒ ì™„ë²½ êµ¬í˜„**

**ë¬¸ì œ :** ê°™ì€ ë¸Œë¼ìš°ì €ë¡œ ì„¸ì…˜ID ì¿ í‚¤ ê³µìœ  -> ì„œë²„ ì„¸ì…˜ ì €ì¥ì†Œ ë‚´ ê°™ì€ ì„¸ì…˜ ì‚¬ìš©<br>
ë¡œê·¸ì¸ì„ í•  ë•Œë§ˆë‹¤ ì„¸ì…˜ì— ì €ì¥ë˜ëŠ” userId, email ë§¤ë²ˆ ê°±ì‹ ë¨<br>
ë˜í•œ ë¡œê·¸ì¸, ë¡œê·¸ì•„ì›ƒì„ í•  ë•Œë§ˆë‹¤ ê¸°ì¡´ ì„¸ì…˜ì„ ë¬´íš¨í™”ì‹œí‚´ .invalidate()<br>

ë”°ë¼ì„œ ìƒˆ íƒ­ì—ì„œ ë¡œê·¸ì¸ ì‹œ ê¸°ì¡´ ë¡œê·¸ì¸ ì •ë³´ëŠ” í•­ìƒ ìƒˆ ì‚¬ìš©ìë¡œ ë®ì–´ì”Œì›Œì§ : ë‹¨ì¼ ì‚¬ìš©ì ë¡œê·¸ì¸ ìƒíƒœ<br>

---
**í•´ê²° :** ë” ì´ìƒ ì„¸ì…˜ì„ ë¬´íš¨í™”í•˜ì§€ ì•Šê³  ê°™ì€ ì„¸ì…˜ ë‚´ì— ì‚¬ìš©ìë³„ ê°œë³„ ì„¸ì…˜ ê³µê°„ ì¶”ê°€ êµ¬í˜„<br>
```java
String sessionId = UUID.randomUUID().toString(); // ì„ì˜ì˜ ê³ ìœ  IDë¡œ ì„¸ì…˜ ìƒì„±
Map<String, Object> memberSession = Map.of(
    "email", member.getEmail()
);
session.setAttribute("userId_" + sessionId, memberSession); // ì‚¬ìš©ì ì„¸ì…˜
```
ê¸°ì¡´ ë¡œê·¸ì¸ ì •ë³´ê°€ ë®ì–´ì”Œì›Œì§€ì§€ ì•Šë„ë¡ userIdê°€ ì•„ë‹Œ ì‚¬ìš©ìë³„ ì„¸ì…˜ ê³µê°„ì„ ê²€ì‚¬ -> ë‹¤ì¤‘ ë¡œê·¸ì¸ í—ˆìš©<br>
```java
@RequestParam(name = "sId", defaultValue = "") String sessionId

Map<String, Object> memberSession = (Map<String, Object>) session.getAttribute("userId_" + sessionId); // ì„¸ì…˜ ì•„ì´ë”” ì¡´ì¬ í™•ì¸
if (memberSession == null) {
    return "redirect:/member_login"; // ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ë¦¬ë‹¤ì´ë ‰ì…˜
}
String email = (String) memberSession.get("email"); // ì„¸ì…˜ì—ì„œ ì‚¬ìš©ì ì‹ë³„ í›„ ì‚¬ìš©ì ì •ë³´ì—ì„œ ê°€ì ¸ì˜´
```
í•˜ì§€ë§Œ ìš”ì²­ì„ ë³´ë‚¸ ì‚¬ìš©ìê°€ ëˆ„êµ¬ì¸ì§€, ì–´ëŠ ê°œë³„ ì„¸ì…˜ ê³µê°„ì¸ì§€ ì–´ë–»ê²Œ êµ¬ë¶„í• ê¹Œ?<br>
-> ëª¨ë“  ìš”ì²­ì— ê°œë³„ ì„¸ì…˜ì„ êµ¬ë³„í•˜ê¸° ìœ„í•œ sId(sessionId) ì¶”ê°€í•˜ì—¬ ì‚¬ìš©ì ì‹ë³„<br>
```java
// ë¦¬ë‹¤ì´ë ‰íŠ¸ë©´ ì¿¼ë¦¬ìŠ¤íŠ¸ë§
"redirect:/board_list?sId=" + sessionId
// GetMapping ì´ë©´ ì¿¼ë¦¬ìŠ¤íŠ¸ë§
@RequestParam(name = "sId", defaultValue = "") String sessionId
// Post/Delete/Put Mapping ì´ë©´ ê²½ë¡œë³€ìˆ˜
@PathVariable("sId") String sessionId
```
ê°™ì€ í¬ë¡¬ ë¸Œë¼ìš°ì €ì—ì„œ ê°œë³„ íƒ­ì— ë¡œê·¸ì¸ëœ ë‘ê°œ ì´ìƒì˜ ê³„ì •ì€ ê°œë³„ì ìœ¼ë¡œ ê¸€ ì¶”ê°€, ì¡°íšŒ, ìˆ˜ì •, ì‚­ì œ ê°€ëŠ¥<br>
=> **ë‹¤ì¤‘ ì‚¬ìš©ì ì™„ë²½ êµ¬í˜„**<br>
ë¡œê·¸ì•„ì›ƒ ì‹œì—ë„ ë” ì´ìƒ ì„¸ì…˜ì„ ë¬´íš¨í™”í•˜ì§€ ì•Šê³  ì‚¬ìš©ìì˜ ê°œë³„ ì„¸ì…˜ ê³µê°„ë§Œ ì‚­ì œ.<br>
```java
session.removeAttribute("userId_" + sId)
```
But ì¿ í‚¤ë¥¼ ì‚­ì œí•˜ë¯€ë¡œ ë‹¤ì¤‘ ì‚¬ìš©ì ì¼ê´„ ë¡œê·¸ì•„ì›ƒ ì²˜ë¦¬
<p align="center">
  <img src="https://github.com/user-attachments/assets/9bdb8fd2-91c6-4d7e-bca8-212db9417821"  width="80%" height="80%"/>
</p>
<p align="center">
  <img src="https://github.com/user-attachments/assets/9e84f6f0-e57b-444f-81de-1d424b441532"  width="80%" height="80%"/>
</p>

**ìš”ì•½**
```java
@PostMapping("/api/login_check")
public String checkMembers(
    @ModelAttribute AddMemberRequest request,
    Model model,
    HttpServletRequest request2, 
    HttpServletResponse response) 
{
    HttpSession session = request2.getSession(true); // ìƒˆë¡œìš´ ì„¸ì…˜ ìƒì„±
                
    // ë¡œê·¸ì¸ ì²´í¬
    Member member = memberService.loginCheck(request.getEmail(), request.getPassword()); // íŒ¨ìŠ¤ì›Œë“œ ë°˜í™˜

    // ì„œë²„ì˜ ì„¸ì…˜ ì €ì¥ì†Œì— ì €ì¥ / JSESSIONID: ì¿ í‚¤ì™€ ì„¸ì…˜ ì €ì¥ì†Œì— ì €ì¥í•˜ì—¬ ë§¤ ìš”ì²­ ë§ˆë‹¤ ì‚¬ìš©ì ì„¸ì…˜ ì‹ë³„
    String sessionId = UUID.randomUUID().toString(); // ì„ì˜ì˜ ê³ ìœ  IDë¡œ ì„¸ì…˜ ìƒì„±
    Map<String, Object> memberSession = Map.of(
        "email", member.getEmail()
    );
    session.setAttribute("userId_" + sessionId, memberSession); // ì‚¬ìš©ì ì„¸ì…˜ ì‹ë³„
    return "redirect:/board_list?sId=" + sessionId; // ë¡œê·¸ì¸ ì„±ê³µ í›„ ì´ë™í•  í˜ì´ì§€
}

@GetMapping("/api/logout/{sId}") // ë¡œê·¸ì•„ì›ƒ ë²„íŠ¼ ë™ì‘
public String member_logout(Model model, HttpServletRequest request2, HttpServletResponse response, @PathVariable String sId) {
    HttpSession session = request2.getSession(false); // ê¸°ì¡´ ì„¸ì…˜ ê°€ì ¸ì˜¤ê¸°(ì¡´ì¬í•˜ì§€ ì•Šìœ¼ë©´ null ë°˜í™˜)
    session.removeAttribute("userId_" + sId); 
    
    Cookie cookie = new Cookie("JSESSIONID", null); // ê¸°ë³¸ ì´ë¦„ì€ JSESSIONID
    cookie.setPath("/"); // ì¿ í‚¤ì˜ ê²½ë¡œ
    cookie.setMaxAge(0); // ì¿ í‚¤ ë§Œë£Œ 0ì´ë©´ ì‚­ì œ
    response.addCookie(cookie); // ì‘ë‹µì— ì¿ í‚¤ ì„¤ì •

    System.out.println("ì„¸ì…˜ userId_" + sId + " :"); // ì´ˆê¸°í™” í›„ IDE í„°ë¯¸ë„ì— ì„¸ì…˜ ê°’ ì¶œë ¥
    System.out.println(session.getAttribute("userId_" + sId));
    
    return "login"; // ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸
}
```
ê¸°ì¡´ Java ì½”ë“œ ë° html íƒœê·¸ ëª¨ë‘ ìˆ˜ì •<br>
í˜„ì¬ ìš”ì²­ì˜ ì‚¬ìš©ìë¥¼ ì‹ë³„ & ì‚¬ìš©ìë³„ ì„¸ì…˜IDì— ì ‘ê·¼í•  ìˆ˜ ìˆë„ë¡ ê²½ë¡œë³€ìˆ˜ ë˜ëŠ” ì¿¼ë¦¬ìŠ¤íŠ¸ë§ìœ¼ë¡œ sId(sessionId) ì „ë‹¬
```java
@GetMapping("/board_list") // ìƒˆë¡œìš´ ê²Œì‹œíŒ ë§í¬ ì§€ì •
public String board_list(
    Model model,
    @RequestParam(name = "sId", defaultValue = "") String sessionId,
    HttpSession session) // ì„¸ì…˜ ê°ì²´ ì „ë‹¬
{
    // Object íƒ€ì…ìœ¼ë¡œ ë°˜í™˜ë˜ë¯€ë¡œ íƒ€ì… ìºìŠ¤íŒ…
    Map<String, Object> memberSession = (Map<String, Object>) session.getAttribute("userId_" + sessionId); // ì„¸ì…˜ ì•„ì´ë”” ì¡´ì¬ í™•ì¸
    if (memberSession == null) {
        return "redirect:/member_login"; // ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ë¦¬ë‹¤ì´ë ‰ì…˜
    }
    String email = (String) memberSession.get("email"); // ì„¸ì…˜ì—ì„œ ì‚¬ìš©ì ì‹ë³„ í›„ ì‚¬ìš©ì ì •ë³´ì—ì„œ ê°€ì ¸ì˜´

    System.out.println("ì„¸ì…˜ userId_" + sessionId + " :");
    System.out.println(memberSession);
    model.addAttribute("sessionId", sessionId);
    return "board_list"; // .HTML ì—°ê²°
}
```
```html
<!-- ê¸€ ì¶”ê°€ -->
<a class="btn btn-warning" th:href="@{/board_write(sId=${sessionId})}">ê¸€ì“°ê¸°</a>
<!-- ê¸€ ì¡°íšŒ -->
<a th:href="@{/board_view/{id}(id=${board.id}, sId=${sessionId})}">
<!-- í˜ì´ì§€ ë§í¬ -->
<a class="page-link" th:href="@{/board_list(page=${i}, keyword=${keyword}, sId=${sessionId})}" th:text="${i + 1}">1</a>
```
10ì£¼ì°¨ ì—°ìŠµë¬¸ì œ ìˆ˜ì •<br>
ì‚¬ìš©ì ì´ë¦„ìœ¼ë¡œ ê²Œì‹œê¸€ ì €ì¥ ê¸°ëŠ¥
```java
// board ê²Œì‹œíŒ ê¸€ ì¶”ê°€
@PostMapping("/api/boards/{sId}") // ê¸€ì“°ê¸° ê²Œì‹œíŒ ì €ì¥
public String addboards(@ModelAttribute AddArticleRequest request, @PathVariable("sId") String sessionId, HttpSession session) {
    // ì„¸ì…˜ì—ì„œ ì‚¬ìš©ì ì‹ë³„
    Map<String, Object> memberSession = (Map<String, Object>) session.getAttribute("userId_" + sessionId);
    String email = (String) memberSession.get("email");
    Member member = memberRepository.findByEmail(email);
    // DTO ì‘ì„±ìë¥¼ ì‚¬ìš©ì ì´ë¦„ìœ¼ë¡œ ë³€ê²½
    request.setUser(member.getName());
    blogService.save(request);
    return "redirect:/board_list?sId=" + sessionId; // .HTML ì—°ê²°
}
```
ê°™ì€ ì‚¬ìš©ìì¼ ê²½ìš°ë§Œ ìˆ˜ì •, ì‚­ì œ ë²„íŠ¼ í™œì„±í™”
```java
// ê²Œì‹œê¸€ ì¡°íšŒ
@GetMapping("/board_view/{id}") // ê²Œì‹œíŒ ë§í¬ ì§€ì •
public String board_view(Model model, @PathVariable Long id, HttpSession session, @RequestParam("sId") String sessionId) {
    Optional<Board> list = blogService.findById(id); // ì„ íƒí•œ ê²Œì‹œíŒ ê¸€
    if (list.isPresent()) {
        model.addAttribute("boards", list.get()); // ì¡´ì¬í•  ê²½ìš° ì‹¤ì œ Board ê°ì²´ë¥¼ ëª¨ë¸ì— ì¶”ê°€
    } else {
    // ì²˜ë¦¬í•  ë¡œì§ ì¶”ê°€ (ì˜ˆ: ì˜¤ë¥˜ í˜ì´ì§€ë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸, ì˜ˆì™¸ ì²˜ë¦¬ ë“±)
        return "/error_page/article_error"; // ì˜¤ë¥˜ ì²˜ë¦¬ í˜ì´ì§€ë¡œ ì—°ê²°
    }

    // ì‚¬ìš©ì ì„¸ì…˜ ì‹ë³„
    Map<String, Object> memberSession = (Map<String, Object>) session.getAttribute("userId_" + sessionId);
    String email = (String) memberSession.get("email");
    Member member = memberRepository.findByEmail(email);
    
    if(list.get().getUser().equals(member.getName())){
        model.addAttribute("user", true);
        model.addAttribute("sessionId", sessionId);
    }
    return "board_view"; // .HTML ì—°ê²°
}
```

- **íŒŒì¼ ì¤‘ë³µ ì‹œ íŒŒì¼ ì´ë¦„ ìë™ ë³€ê²½ ë° ì—ëŸ¬ í˜ì´ì§€ ì²˜ë¦¬**

While ë¬¸ì„ í†µí•´ ì¤‘ë³µ íŒŒì¼ì´ ìˆëŠ”ì§€ í™•ì¸í•˜ê³  íŒŒì¼ ì´ë¦„ì„ ë³€ê²½
```java
String sanitizedEmail = email.replaceAll("[^a-zA-Z0-9]", "_");
Path filePath = uploadPath.resolve(sanitizedEmail + ".txt"); // ì—…ë¡œë“œ í´ë”ì— .txt ì´ë¦„ ì„¤ì •
int count = 1;
while (Files.exists(filePath)) {
    filePath = uploadPath.resolve(sanitizedEmail + "(" + count + ")" + ".txt");
    count ++;
}
```
íŒŒì¼ ì—…ë¡œë“œ ì—ëŸ¬ í˜ì´ì§€ êµ¬í˜„
```java
catch (IOException e) {
    e.printStackTrace(); // ì½˜ì†”ì— ì—ëŸ¬ ë¡œê·¸ ì¶œë ¥
    redirectAttributes.addFlashAttribute("message", "ì—…ë¡œë“œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
    return "/error_page/file_error"; // ì˜¤ë¥˜ ì²˜ë¦¬ í˜ì´ì§€ë¡œ ì—°ê²°
}
```
```html
<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8">
    <title>ë¸”ë¡œê·¸ ê²Œì‹œíŒ</title>
    <meta content="width=device-width, initial-scale=1.0" name="viewport">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
</head>
<body>
    <div class="container">
    <h1 class="mt-5 text-danger">ë¸”ë¡œê·¸ ê²Œì‹œíŒ - ì˜ëª»ëœ ì ‘ê·¼</h1>
    <!-- ì˜¤ë¥˜ ë©”ì‹œì§€ -->
    <div class="alert alert-danger mt-4" role="alert">
    <h4 class="alert-heading">ì˜ëª»ëœ ì ‘ê·¼ì…ë‹ˆë‹¤!</h4>
    <p th:text="message"></p>
    <hr>
    <p class="mb-0">ì´ì „ í˜ì´ì§€ë¡œ ëŒì•„ê°€ì‹œë ¤ë©´ ì•„ë˜ ë²„íŠ¼ì„ í´ë¦­í•´ì£¼ì„¸ìš”.</p>
    </div>
    <!-- ì´ì „ í˜ì´ì§€ë¡œ ëŒì•„ê°€ëŠ” ë²„íŠ¼ -->
    <div class="mt-4">
    <a href="javascript:history.back()" class="btn btn-primary">ì´ì „ í˜ì´ì§€ë¡œ</a>
    </div>
    </div>
</body>
</html>
```

## âœ… ìµœì¢… í™•ì¸
### ëª¨ë“  ì£¼ì°¨ ìˆ˜ì—… ë‚´ìš© ì™„ë£Œ âœ…
### ëª¨ë“  ì£¼ì°¨ ì—°ìŠµë¬¸ì œ í•´ê²° ì™„ë£Œ âœ…
### í¬íŠ¸í´ë¦¬ì˜¤ í˜ì´ì§€ ì´ë¯¸ì§€, ë‚´ìš© ì¶”ê°€ ì™„ë£Œ âœ…
